<?xml version="1.0" encoding="ISO-8859-1" ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core"
	template="/WEB-INF/templates/template.xhtml">

	<ui:define name="contenu">
		<p:remoteCommand name="update" update="container" process="container"
			ignoreAutoUpdate="true" />

		<p:poll widgetVar="myPoll" interval="5" autoStart="false"
			listener="#{teamViewBean.increment}" />

		<p:fieldset id="chat" legend="Chat" toggleable="true">
			<p:outputPanel id="public" layout="block"
				styleClass="ui-corner-all ui-widget-content chatlogs" />
		</p:fieldset>
		
		<p:fieldset id="container" legend="Container" toggleable="true">

			<h:panelGroup rendered="#{teamViewBean.admin}">
				<p:commandButton value="Start"
					disabled="#{teamViewBean.player != null}"
					action="#{teamViewBean.startAuction}" />
				<p:commandButton value="End" onclick="PF('myPoll').stop();"
					rendered="#{teamViewBean.player != null}"
					action="#{teamViewBean.endAuction}" />
			</h:panelGroup>

			<h:panelGroup rendered="#{teamViewBean.loggedIn}">

				<h:panelGrid columns="2" style="width:100%">
					<p:dataList id="teams" var="team"
						value="#{auctionsBean.getTeams('asta')}">
						<f:facet name="header">
							<h:outputLabel value="Teams" />
						</f:facet>
                    	#{team.name}
                	</p:dataList>
				</h:panelGrid>

				<p:separator />

				<h:outputText id="txt_count" value="#{teamViewBean.timer.number}" />

				<h:panelGrid rendered="#{teamViewBean.player != null}" columns="2"
					style="width:100%">
					<h:outputLabel value="#{teamViewBean.player.surname}" />
					<p:dataList id="bids" var="bid" value="#{teamViewBean.getBids()}">
						<f:facet name="header">
							<h:outputLabel value="Bids" />
						</f:facet>
	                    #{bid.teamName}: #{bid.value}
	                </p:dataList>
				</h:panelGrid>

				<p:separator />

				<h:panelGrid
					
					columns="2">
					<p:inputText id="bidValue" value="#{teamViewBean.bid}" />
					<p:commandButton value="Send Bid" disabled="#{teamViewBean.player == null}" action="#{teamViewBean.sendBid}" />
				</h:panelGrid>

				<h:panelGrid columns="3">
					<p:inputText id="messageValue" value="#{teamViewBean.message}" />
					<p:commandButton value="Send Message"
						action="#{teamViewBean.sendMessage}" />
					<p:commandButton value="Disconnect"
						actionListener="#{teamViewBean.disconnect}" />
				</h:panelGrid>

				<p:fieldset id="team" legend="#{teamViewBean.team.name}" toggleable="true" rendered="#{not teamViewBean.admin}">
						Budget Rimanente: #{teamViewBean.team.budget}						
						<p:dataList id="players" var="p" value="#{teamViewBean.team.getPlayers()}">
								<f:facet name="header">
									<h:outputLabel value="Players" />
								</f:facet>
			                    #{p.name} #{p.surname} #{p.role} #{p.team} Prezzo: #{p.price}
			             </p:dataList>
				</p:fieldset>
			
			</h:panelGroup>

			<h:panelGroup rendered="#{not teamViewBean.loggedIn}">
            Team: <p:inputText value="#{teamViewBean.teamName}" />

				<p:spacer width="5" />
				<p:commandButton value="Login"
					action="#{teamViewBean.login(auctionsBean.getLeague('asta'))}"
					icon="ui-icon-person" />
			</h:panelGroup>

		</p:fieldset>
		
		
	</ui:define>

</ui:composition>